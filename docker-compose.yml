services:
  jmeter:
    image: justb4/jmeter:5.5
    container_name: jmeter_runner
    platform: linux/amd64
    volumes:
      - ./tests/jmeter:/tests   # tudo aqui vira /tests
      - ./results:/results
    entrypoint:
      - sh
      - -c
      - |
        echo "ğŸ” Arquivos em /tests:"
        ls -la /tests/

        echo "ğŸ” ConteÃºdo do credenciais.csv:"
        cat /tests/credenciais.csv || echo "âŒ Arquivo nÃ£o encontrado!"

        rm -f /results/result.jtl
        rm -rf /results/html-report
        mkdir -p /results

        jmeter -n \
          -t /tests/Demo-Shop-Performance-Test.jmx \
          -l /results/result.jtl \
          -e -o /results/html-report \
          -Jjmeter.save.saveservice.output_format=csv
